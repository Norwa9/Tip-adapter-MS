2022-06-03 09:16:31:INFO:Namespace(alpha=1, attn_dropout=0.2, attn_mask=True, augment_epoch=10, batch_size=512, beta=1.17, embed_dim=1024, embed_dropout=0.25, k_shot=16, layers=1, lr=0.015, num_heads=2, refine_epoch=60, refine_lr=0.02, relu_dropout=0.2, res_dropout=0.2, temperature=0.05, topK=5, train_epoch=20, transformer_alpha=1.0, transformer_beta=1.17)
2022-06-03 09:16:43:INFO:1000 classes, 7 templates
2022-06-03 09:17:05:INFO:Load data finished.
2022-06-03 09:17:06:INFO:Loading saved text features.
2022-06-03 09:17:06:INFO:Loading training image features
2022-06-03 09:17:06:INFO:start saving testing image features
2022-06-03 09:17:06:INFO:Loading fintuned adapter parameters..
2022-06-03 09:17:06:INFO:Loading testing prototypes and testing zeroshot weights...
2022-06-03 09:17:08:INFO:Refine time: 1 / 60
2022-06-03 09:17:39:INFO:LR: 0.019986, Acc: 0.8384 (13415.0/16000), Loss: 1.5310
2022-06-03 09:17:43:INFO:Refine Top-1 Accuracy: 59.12
2022-06-03 09:17:43:INFO:Stage2: Saving best model..
2022-06-03 09:17:43:INFO:Refine time: 2 / 60
2022-06-03 09:18:17:INFO:LR: 0.019945, Acc: 0.8629 (13806.0/16000), Loss: 1.4208
2022-06-03 09:18:20:INFO:Refine Top-1 Accuracy: 61.16
2022-06-03 09:18:20:INFO:Stage2: Saving best model..
2022-06-03 09:18:20:INFO:Refine time: 3 / 60
2022-06-03 09:18:49:INFO:LR: 0.019877, Acc: 0.8668 (13868.0/16000), Loss: 1.4073
2022-06-03 09:18:51:INFO:Refine Top-1 Accuracy: 59.95
2022-06-03 09:18:51:INFO:Refine time: 4 / 60
2022-06-03 09:19:19:INFO:LR: 0.019781, Acc: 0.8696 (13914.0/16000), Loss: 1.3955
2022-06-03 09:19:21:INFO:Refine Top-1 Accuracy: 61.60
2022-06-03 09:19:21:INFO:Stage2: Saving best model..
2022-06-03 09:19:21:INFO:Refine time: 5 / 60
2022-06-03 09:19:49:INFO:LR: 0.019659, Acc: 0.8793 (14069.0/16000), Loss: 1.3892
2022-06-03 09:19:51:INFO:Refine Top-1 Accuracy: 62.55
2022-06-03 09:19:51:INFO:Stage2: Saving best model..
2022-06-03 09:19:52:INFO:Refine time: 6 / 60
2022-06-03 09:20:19:INFO:LR: 0.019511, Acc: 0.8864 (14183.0/16000), Loss: 1.3856
2022-06-03 09:20:21:INFO:Refine Top-1 Accuracy: 60.03
2022-06-03 09:20:21:INFO:Refine time: 7 / 60
2022-06-03 09:20:49:INFO:LR: 0.019336, Acc: 0.8832 (14132.0/16000), Loss: 1.3831
2022-06-03 09:20:51:INFO:Refine Top-1 Accuracy: 62.19
2022-06-03 09:20:51:INFO:Refine time: 8 / 60
2022-06-03 09:21:18:INFO:LR: 0.019135, Acc: 0.8890 (14224.0/16000), Loss: 1.3791
2022-06-03 09:21:20:INFO:Refine Top-1 Accuracy: 62.03
2022-06-03 09:21:20:INFO:Refine time: 9 / 60
2022-06-03 09:21:49:INFO:LR: 0.018910, Acc: 0.8969 (14351.0/16000), Loss: 1.3751
2022-06-03 09:21:51:INFO:Refine Top-1 Accuracy: 60.49
2022-06-03 09:21:51:INFO:Refine time: 10 / 60
2022-06-03 09:22:19:INFO:LR: 0.018660, Acc: 0.9116 (14585.0/16000), Loss: 1.3663
2022-06-03 09:22:21:INFO:Refine Top-1 Accuracy: 58.80
2022-06-03 09:22:21:INFO:Refine time: 11 / 60
2022-06-03 09:22:48:INFO:LR: 0.018387, Acc: 0.9164 (14662.0/16000), Loss: 1.3657
2022-06-03 09:22:50:INFO:Refine Top-1 Accuracy: 55.04
2022-06-03 09:22:50:INFO:Refine time: 12 / 60
2022-06-03 09:23:16:INFO:LR: 0.018090, Acc: 0.9251 (14801.0/16000), Loss: 1.3610
2022-06-03 09:23:18:INFO:Refine Top-1 Accuracy: 61.21
2022-06-03 09:23:18:INFO:Refine time: 13 / 60
2022-06-03 09:23:44:INFO:LR: 0.017771, Acc: 0.9349 (14959.0/16000), Loss: 1.3498
2022-06-03 09:23:46:INFO:Refine Top-1 Accuracy: 56.11
2022-06-03 09:23:46:INFO:Refine time: 14 / 60
2022-06-03 09:24:12:INFO:LR: 0.017431, Acc: 0.9351 (14962.0/16000), Loss: 1.3492
2022-06-03 09:24:14:INFO:Refine Top-1 Accuracy: 60.49
2022-06-03 09:24:14:INFO:Refine time: 15 / 60
2022-06-03 09:24:40:INFO:LR: 0.017071, Acc: 0.9479 (15166.0/16000), Loss: 1.3391
2022-06-03 09:24:42:INFO:Refine Top-1 Accuracy: 58.12
2022-06-03 09:24:42:INFO:Refine time: 16 / 60
2022-06-03 09:25:08:INFO:LR: 0.016691, Acc: 0.9523 (15236.0/16000), Loss: 1.3362
2022-06-03 09:25:10:INFO:Refine Top-1 Accuracy: 60.13
2022-06-03 09:25:10:INFO:Refine time: 17 / 60
2022-06-03 09:25:36:INFO:LR: 0.016293, Acc: 0.9594 (15350.0/16000), Loss: 1.3299
2022-06-03 09:25:38:INFO:Refine Top-1 Accuracy: 59.45
2022-06-03 09:25:38:INFO:Refine time: 18 / 60
2022-06-03 09:26:06:INFO:LR: 0.015878, Acc: 0.9644 (15430.0/16000), Loss: 1.3232
2022-06-03 09:26:09:INFO:Refine Top-1 Accuracy: 58.84
2022-06-03 09:26:09:INFO:Refine time: 19 / 60
2022-06-03 09:26:38:INFO:LR: 0.015446, Acc: 0.9666 (15466.0/16000), Loss: 1.3170
2022-06-03 09:26:40:INFO:Refine Top-1 Accuracy: 58.92
2022-06-03 09:26:40:INFO:Refine time: 20 / 60
2022-06-03 09:27:11:INFO:LR: 0.015000, Acc: 0.9720 (15552.0/16000), Loss: 1.3126
2022-06-03 09:27:14:INFO:Refine Top-1 Accuracy: 59.27
2022-06-03 09:27:14:INFO:Refine time: 21 / 60
2022-06-03 09:27:42:INFO:LR: 0.014540, Acc: 0.9741 (15585.0/16000), Loss: 1.3089
2022-06-03 09:27:43:INFO:Refine Top-1 Accuracy: 57.31
2022-06-03 09:27:43:INFO:Refine time: 22 / 60
2022-06-03 09:28:11:INFO:LR: 0.014067, Acc: 0.9768 (15629.0/16000), Loss: 1.3044
2022-06-03 09:28:12:INFO:Refine Top-1 Accuracy: 58.44
2022-06-03 09:28:12:INFO:Refine time: 23 / 60
2022-06-03 09:28:38:INFO:LR: 0.013584, Acc: 0.9759 (15614.0/16000), Loss: 1.3019
2022-06-03 09:28:40:INFO:Refine Top-1 Accuracy: 56.27
2022-06-03 09:28:40:INFO:Refine time: 24 / 60
2022-06-03 09:29:07:INFO:LR: 0.013090, Acc: 0.9821 (15713.0/16000), Loss: 1.2931
2022-06-03 09:29:09:INFO:Refine Top-1 Accuracy: 51.65
2022-06-03 09:29:09:INFO:Refine time: 25 / 60
2022-06-03 09:29:35:INFO:LR: 0.012588, Acc: 0.9821 (15713.0/16000), Loss: 1.2917
2022-06-03 09:29:37:INFO:Refine Top-1 Accuracy: 54.76
2022-06-03 09:29:37:INFO:Refine time: 26 / 60
2022-06-03 09:30:03:INFO:LR: 0.012079, Acc: 0.9861 (15777.0/16000), Loss: 1.2864
2022-06-03 09:30:05:INFO:Refine Top-1 Accuracy: 55.84
2022-06-03 09:30:05:INFO:Refine time: 27 / 60
2022-06-03 09:30:32:INFO:LR: 0.011564, Acc: 0.9864 (15782.0/16000), Loss: 1.2806
2022-06-03 09:30:34:INFO:Refine Top-1 Accuracy: 55.17
2022-06-03 09:30:34:INFO:Refine time: 28 / 60
2022-06-03 09:31:00:INFO:LR: 0.011045, Acc: 0.9880 (15808.0/16000), Loss: 1.2779
2022-06-03 09:31:02:INFO:Refine Top-1 Accuracy: 56.63
2022-06-03 09:31:02:INFO:Refine time: 29 / 60
2022-06-03 09:31:28:INFO:LR: 0.010523, Acc: 0.9892 (15828.0/16000), Loss: 1.2730
2022-06-03 09:31:31:INFO:Refine Top-1 Accuracy: 52.81
2022-06-03 09:31:31:INFO:Refine time: 30 / 60
2022-06-03 09:31:56:INFO:LR: 0.010000, Acc: 0.9902 (15844.0/16000), Loss: 1.2724
2022-06-03 09:31:58:INFO:Refine Top-1 Accuracy: 58.07
2022-06-03 09:31:58:INFO:Refine time: 31 / 60
2022-06-03 09:32:27:INFO:LR: 0.009477, Acc: 0.9908 (15853.0/16000), Loss: 1.2701
2022-06-03 09:32:30:INFO:Refine Top-1 Accuracy: 57.43
2022-06-03 09:32:30:INFO:Refine time: 32 / 60
2022-06-03 09:33:01:INFO:LR: 0.008955, Acc: 0.9918 (15868.0/16000), Loss: 1.2664
2022-06-03 09:33:03:INFO:Refine Top-1 Accuracy: 57.07
2022-06-03 09:33:03:INFO:Refine time: 33 / 60
2022-06-03 09:33:30:INFO:LR: 0.008436, Acc: 0.9914 (15863.0/16000), Loss: 1.2650
2022-06-03 09:33:31:INFO:Refine Top-1 Accuracy: 58.79
2022-06-03 09:33:31:INFO:Refine time: 34 / 60
2022-06-03 09:33:57:INFO:LR: 0.007921, Acc: 0.9919 (15870.0/16000), Loss: 1.2645
2022-06-03 09:33:59:INFO:Refine Top-1 Accuracy: 59.12
2022-06-03 09:33:59:INFO:Refine time: 35 / 60
2022-06-03 09:34:25:INFO:LR: 0.007412, Acc: 0.9914 (15862.0/16000), Loss: 1.2621
2022-06-03 09:34:27:INFO:Refine Top-1 Accuracy: 55.17
2022-06-03 09:34:27:INFO:Refine time: 36 / 60
2022-06-03 09:34:56:INFO:LR: 0.006910, Acc: 0.9917 (15867.0/16000), Loss: 1.2622
2022-06-03 09:34:58:INFO:Refine Top-1 Accuracy: 54.03
2022-06-03 09:34:58:INFO:Refine time: 37 / 60
2022-06-03 09:35:29:INFO:LR: 0.006416, Acc: 0.9928 (15885.0/16000), Loss: 1.2599
2022-06-03 09:35:30:INFO:Refine Top-1 Accuracy: 56.00
2022-06-03 09:35:30:INFO:Refine time: 38 / 60
2022-06-03 09:35:57:INFO:LR: 0.005933, Acc: 0.9921 (15873.0/16000), Loss: 1.2585
2022-06-03 09:36:00:INFO:Refine Top-1 Accuracy: 57.50
2022-06-03 09:36:00:INFO:Refine time: 39 / 60
2022-06-03 09:36:32:INFO:LR: 0.005460, Acc: 0.9924 (15879.0/16000), Loss: 1.2577
2022-06-03 09:36:34:INFO:Refine Top-1 Accuracy: 57.75
2022-06-03 09:36:34:INFO:Refine time: 40 / 60
2022-06-03 09:37:03:INFO:LR: 0.005000, Acc: 0.9928 (15884.0/16000), Loss: 1.2558
2022-06-03 09:37:04:INFO:Refine Top-1 Accuracy: 58.33
2022-06-03 09:37:05:INFO:Refine time: 41 / 60
2022-06-03 09:37:32:INFO:LR: 0.004554, Acc: 0.9935 (15896.0/16000), Loss: 1.2546
2022-06-03 09:37:33:INFO:Refine Top-1 Accuracy: 59.89
2022-06-03 09:37:33:INFO:Refine time: 42 / 60
2022-06-03 09:38:00:INFO:LR: 0.004122, Acc: 0.9924 (15879.0/16000), Loss: 1.2541
2022-06-03 09:38:02:INFO:Refine Top-1 Accuracy: 59.43
2022-06-03 09:38:02:INFO:Refine time: 43 / 60
2022-06-03 09:38:29:INFO:LR: 0.003707, Acc: 0.9934 (15895.0/16000), Loss: 1.2529
2022-06-03 09:38:31:INFO:Refine Top-1 Accuracy: 59.05
2022-06-03 09:38:31:INFO:Refine time: 44 / 60
2022-06-03 09:38:57:INFO:LR: 0.003309, Acc: 0.9931 (15890.0/16000), Loss: 1.2523
2022-06-03 09:38:59:INFO:Refine Top-1 Accuracy: 58.27
2022-06-03 09:38:59:INFO:Refine time: 45 / 60
2022-06-03 09:39:25:INFO:LR: 0.002929, Acc: 0.9931 (15889.0/16000), Loss: 1.2515
2022-06-03 09:39:27:INFO:Refine Top-1 Accuracy: 59.43
2022-06-03 09:39:27:INFO:Refine time: 46 / 60
2022-06-03 09:39:54:INFO:LR: 0.002569, Acc: 0.9926 (15881.0/16000), Loss: 1.2514
2022-06-03 09:39:56:INFO:Refine Top-1 Accuracy: 59.64
2022-06-03 09:39:56:INFO:Refine time: 47 / 60
2022-06-03 09:40:22:INFO:LR: 0.002229, Acc: 0.9935 (15896.0/16000), Loss: 1.2499
2022-06-03 09:40:24:INFO:Refine Top-1 Accuracy: 59.29
2022-06-03 09:40:24:INFO:Refine time: 48 / 60
2022-06-03 09:40:49:INFO:LR: 0.001910, Acc: 0.9938 (15900.0/16000), Loss: 1.2498
2022-06-03 09:40:51:INFO:Refine Top-1 Accuracy: 58.87
2022-06-03 09:40:51:INFO:Refine time: 49 / 60
2022-06-03 09:41:17:INFO:LR: 0.001613, Acc: 0.9941 (15906.0/16000), Loss: 1.2493
2022-06-03 09:41:19:INFO:Refine Top-1 Accuracy: 59.98
2022-06-03 09:41:19:INFO:Refine time: 50 / 60
2022-06-03 09:41:45:INFO:LR: 0.001340, Acc: 0.9942 (15907.0/16000), Loss: 1.2491
2022-06-03 09:41:48:INFO:Refine Top-1 Accuracy: 59.49
2022-06-03 09:41:48:INFO:Refine time: 51 / 60
2022-06-03 09:42:14:INFO:LR: 0.001090, Acc: 0.9932 (15892.0/16000), Loss: 1.2487
2022-06-03 09:42:16:INFO:Refine Top-1 Accuracy: 59.82
2022-06-03 09:42:16:INFO:Refine time: 52 / 60
2022-06-03 09:42:42:INFO:LR: 0.000865, Acc: 0.9930 (15888.0/16000), Loss: 1.2486
2022-06-03 09:42:44:INFO:Refine Top-1 Accuracy: 59.80
2022-06-03 09:42:44:INFO:Refine time: 53 / 60
2022-06-03 09:43:11:INFO:LR: 0.000664, Acc: 0.9932 (15891.0/16000), Loss: 1.2477
2022-06-03 09:43:14:INFO:Refine Top-1 Accuracy: 59.47
2022-06-03 09:43:14:INFO:Refine time: 54 / 60
2022-06-03 09:43:42:INFO:LR: 0.000489, Acc: 0.9935 (15896.0/16000), Loss: 1.2480
2022-06-03 09:43:44:INFO:Refine Top-1 Accuracy: 59.66
2022-06-03 09:43:44:INFO:Refine time: 55 / 60
2022-06-03 09:44:13:INFO:LR: 0.000341, Acc: 0.9931 (15890.0/16000), Loss: 1.2480
2022-06-03 09:44:16:INFO:Refine Top-1 Accuracy: 59.42
2022-06-03 09:44:16:INFO:Refine time: 56 / 60
2022-06-03 09:44:42:INFO:LR: 0.000219, Acc: 0.9946 (15913.0/16000), Loss: 1.2462
2022-06-03 09:44:44:INFO:Refine Top-1 Accuracy: 59.49
2022-06-03 09:44:44:INFO:Refine time: 57 / 60
2022-06-03 09:45:14:INFO:LR: 0.000123, Acc: 0.9938 (15900.0/16000), Loss: 1.2470
2022-06-03 09:45:16:INFO:Refine Top-1 Accuracy: 59.57
2022-06-03 09:45:16:INFO:Refine time: 58 / 60
2022-06-03 09:45:46:INFO:LR: 0.000055, Acc: 0.9941 (15905.0/16000), Loss: 1.2470
2022-06-03 09:45:48:INFO:Refine Top-1 Accuracy: 59.86
2022-06-03 09:45:48:INFO:Refine time: 59 / 60
2022-06-03 09:46:14:INFO:LR: 0.000014, Acc: 0.9934 (15894.0/16000), Loss: 1.2479
2022-06-03 09:46:16:INFO:Refine Top-1 Accuracy: 59.81
2022-06-03 09:46:16:INFO:Refine time: 60 / 60
2022-06-03 09:46:42:INFO:LR: 0.000000, Acc: 0.9942 (15907.0/16000), Loss: 1.2470
2022-06-03 09:46:44:INFO:Refine Top-1 Accuracy: 59.78
2022-06-03 09:46:44:INFO:Stage2: Best Testing Top 1 Accuracy: 62.55, at Epoch: 5
