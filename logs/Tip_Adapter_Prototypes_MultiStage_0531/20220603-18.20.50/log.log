2022-06-03 10:20:50:INFO:Namespace(alpha=1, attn_dropout=0.2, attn_mask=True, augment_epoch=10, batch_size=512, beta=1.17, embed_dim=1024, embed_dropout=0.25, k_shot=16, layers=1, lr=0.015, num_heads=2, refine_epoch=60, refine_lr=0.02, relu_dropout=0.2, res_dropout=0.2, temperature=0.05, topK=5, train_epoch=20, transformer_alpha=1.0, transformer_beta=1.17)
2022-06-03 10:20:58:INFO:1000 classes, 7 templates
2022-06-03 10:21:14:INFO:Load data finished.
2022-06-03 10:21:14:INFO:Loading saved text features.
2022-06-03 10:21:14:INFO:Loading training image features
2022-06-03 10:21:15:INFO:start saving testing image features
2022-06-03 10:21:15:INFO:Loading fintuned adapter parameters..
2022-06-03 10:21:15:INFO:Loading testing prototypes and testing zeroshot weights...
2022-06-03 10:21:17:INFO:Refine time: 1 / 60
2022-06-03 10:21:43:INFO:LR: 0.019986, Acc: 0.5488 (8781.0/16000), Loss: 1.5088
2022-06-03 10:21:45:INFO:Refine Top-1 Accuracy: 56.03
2022-06-03 10:21:45:INFO:Stage2: Saving best model..
2022-06-03 10:21:45:INFO:Refine time: 2 / 60
2022-06-03 10:22:11:INFO:LR: 0.019945, Acc: 0.5661 (9058.0/16000), Loss: 1.4505
2022-06-03 10:22:13:INFO:Refine Top-1 Accuracy: 59.14
2022-06-03 10:22:13:INFO:Stage2: Saving best model..
2022-06-03 10:22:14:INFO:Refine time: 3 / 60
2022-06-03 10:22:39:INFO:LR: 0.019877, Acc: 0.6044 (9670.0/16000), Loss: 1.4237
2022-06-03 10:22:41:INFO:Refine Top-1 Accuracy: 60.82
2022-06-03 10:22:41:INFO:Stage2: Saving best model..
2022-06-03 10:22:41:INFO:Refine time: 4 / 60
2022-06-03 10:23:07:INFO:LR: 0.019781, Acc: 0.6114 (9783.0/16000), Loss: 1.4041
2022-06-03 10:23:09:INFO:Refine Top-1 Accuracy: 61.56
2022-06-03 10:23:09:INFO:Stage2: Saving best model..
2022-06-03 10:23:09:INFO:Refine time: 5 / 60
2022-06-03 10:23:35:INFO:LR: 0.019659, Acc: 0.6106 (9769.0/16000), Loss: 1.3958
2022-06-03 10:23:37:INFO:Refine Top-1 Accuracy: 61.69
2022-06-03 10:23:37:INFO:Stage2: Saving best model..
2022-06-03 10:23:37:INFO:Refine time: 6 / 60
2022-06-03 10:24:02:INFO:LR: 0.019511, Acc: 0.6177 (9883.0/16000), Loss: 1.3944
2022-06-03 10:24:04:INFO:Refine Top-1 Accuracy: 61.64
2022-06-03 10:24:04:INFO:Refine time: 7 / 60
2022-06-03 10:24:30:INFO:LR: 0.019336, Acc: 0.6034 (9654.0/16000), Loss: 1.4013
2022-06-03 10:24:32:INFO:Refine Top-1 Accuracy: 60.70
2022-06-03 10:24:32:INFO:Refine time: 8 / 60
2022-06-03 10:24:58:INFO:LR: 0.019135, Acc: 0.6048 (9677.0/16000), Loss: 1.3981
2022-06-03 10:25:00:INFO:Refine Top-1 Accuracy: 61.27
2022-06-03 10:25:00:INFO:Refine time: 9 / 60
2022-06-03 10:25:27:INFO:LR: 0.018910, Acc: 0.6025 (9640.0/16000), Loss: 1.3998
2022-06-03 10:25:30:INFO:Refine Top-1 Accuracy: 61.32
2022-06-03 10:25:30:INFO:Refine time: 10 / 60
2022-06-03 10:26:01:INFO:LR: 0.018660, Acc: 0.6061 (9698.0/16000), Loss: 1.3963
2022-06-03 10:26:03:INFO:Refine Top-1 Accuracy: 61.68
2022-06-03 10:26:03:INFO:Refine time: 11 / 60
2022-06-03 10:26:33:INFO:LR: 0.018387, Acc: 0.6181 (9889.0/16000), Loss: 1.3882
2022-06-03 10:26:35:INFO:Refine Top-1 Accuracy: 61.87
2022-06-03 10:26:35:INFO:Stage2: Saving best model..
2022-06-03 10:26:35:INFO:Refine time: 12 / 60
2022-06-03 10:27:02:INFO:LR: 0.018090, Acc: 0.6126 (9801.0/16000), Loss: 1.3900
2022-06-03 10:27:04:INFO:Refine Top-1 Accuracy: 61.86
2022-06-03 10:27:04:INFO:Refine time: 13 / 60
2022-06-03 10:27:30:INFO:LR: 0.017771, Acc: 0.6188 (9901.0/16000), Loss: 1.3818
2022-06-03 10:27:32:INFO:Refine Top-1 Accuracy: 61.78
2022-06-03 10:27:32:INFO:Refine time: 14 / 60
2022-06-03 10:27:58:INFO:LR: 0.017431, Acc: 0.6158 (9853.0/16000), Loss: 1.3834
2022-06-03 10:28:00:INFO:Refine Top-1 Accuracy: 61.45
2022-06-03 10:28:00:INFO:Refine time: 15 / 60
2022-06-03 10:28:26:INFO:LR: 0.017071, Acc: 0.6164 (9863.0/16000), Loss: 1.3842
2022-06-03 10:28:28:INFO:Refine Top-1 Accuracy: 61.91
2022-06-03 10:28:28:INFO:Stage2: Saving best model..
2022-06-03 10:28:28:INFO:Refine time: 16 / 60
2022-06-03 10:28:54:INFO:LR: 0.016691, Acc: 0.6181 (9889.0/16000), Loss: 1.3800
2022-06-03 10:28:56:INFO:Refine Top-1 Accuracy: 62.00
2022-06-03 10:28:56:INFO:Stage2: Saving best model..
2022-06-03 10:28:56:INFO:Refine time: 17 / 60
2022-06-03 10:29:21:INFO:LR: 0.016293, Acc: 0.6204 (9926.0/16000), Loss: 1.3811
2022-06-03 10:29:23:INFO:Refine Top-1 Accuracy: 61.04
2022-06-03 10:29:23:INFO:Refine time: 18 / 60
2022-06-03 10:29:49:INFO:LR: 0.015878, Acc: 0.6211 (9938.0/16000), Loss: 1.3780
2022-06-03 10:29:51:INFO:Refine Top-1 Accuracy: 61.77
2022-06-03 10:29:51:INFO:Refine time: 19 / 60
2022-06-03 10:30:17:INFO:LR: 0.015446, Acc: 0.6229 (9966.0/16000), Loss: 1.3776
2022-06-03 10:30:19:INFO:Refine Top-1 Accuracy: 62.36
2022-06-03 10:30:19:INFO:Stage2: Saving best model..
2022-06-03 10:30:19:INFO:Refine time: 20 / 60
2022-06-03 10:30:45:INFO:LR: 0.015000, Acc: 0.6288 (10061.0/16000), Loss: 1.3738
2022-06-03 10:30:47:INFO:Refine Top-1 Accuracy: 61.91
2022-06-03 10:30:47:INFO:Refine time: 21 / 60
2022-06-03 10:31:12:INFO:LR: 0.014540, Acc: 0.6234 (9975.0/16000), Loss: 1.3761
2022-06-03 10:31:14:INFO:Refine Top-1 Accuracy: 62.42
2022-06-03 10:31:14:INFO:Stage2: Saving best model..
2022-06-03 10:31:14:INFO:Refine time: 22 / 60
2022-06-03 10:31:40:INFO:LR: 0.014067, Acc: 0.6271 (10034.0/16000), Loss: 1.3728
2022-06-03 10:31:43:INFO:Refine Top-1 Accuracy: 62.68
2022-06-03 10:31:43:INFO:Stage2: Saving best model..
2022-06-03 10:31:43:INFO:Refine time: 23 / 60
2022-06-03 10:32:08:INFO:LR: 0.013584, Acc: 0.6284 (10054.0/16000), Loss: 1.3715
2022-06-03 10:32:11:INFO:Refine Top-1 Accuracy: 62.66
2022-06-03 10:32:11:INFO:Refine time: 24 / 60
2022-06-03 10:32:36:INFO:LR: 0.013090, Acc: 0.6281 (10050.0/16000), Loss: 1.3700
2022-06-03 10:32:38:INFO:Refine Top-1 Accuracy: 62.79
2022-06-03 10:32:38:INFO:Stage2: Saving best model..
2022-06-03 10:32:38:INFO:Refine time: 25 / 60
2022-06-03 10:33:04:INFO:LR: 0.012588, Acc: 0.6292 (10068.0/16000), Loss: 1.3683
2022-06-03 10:33:06:INFO:Refine Top-1 Accuracy: 62.53
2022-06-03 10:33:06:INFO:Refine time: 26 / 60
2022-06-03 10:33:32:INFO:LR: 0.012079, Acc: 0.6359 (10175.0/16000), Loss: 1.3643
2022-06-03 10:33:34:INFO:Refine Top-1 Accuracy: 62.44
2022-06-03 10:33:34:INFO:Refine time: 27 / 60
2022-06-03 10:34:01:INFO:LR: 0.011564, Acc: 0.6363 (10181.0/16000), Loss: 1.3637
2022-06-03 10:34:03:INFO:Refine Top-1 Accuracy: 62.88
2022-06-03 10:34:03:INFO:Stage2: Saving best model..
2022-06-03 10:34:04:INFO:Refine time: 28 / 60
2022-06-03 10:34:33:INFO:LR: 0.011045, Acc: 0.6389 (10223.0/16000), Loss: 1.3641
2022-06-03 10:34:35:INFO:Refine Top-1 Accuracy: 62.78
2022-06-03 10:34:35:INFO:Refine time: 29 / 60
2022-06-03 10:35:02:INFO:LR: 0.010523, Acc: 0.6387 (10219.0/16000), Loss: 1.3607
2022-06-03 10:35:04:INFO:Refine Top-1 Accuracy: 63.16
2022-06-03 10:35:04:INFO:Stage2: Saving best model..
2022-06-03 10:35:04:INFO:Refine time: 30 / 60
2022-06-03 10:35:30:INFO:LR: 0.010000, Acc: 0.6408 (10253.0/16000), Loss: 1.3603
2022-06-03 10:35:32:INFO:Refine Top-1 Accuracy: 63.01
2022-06-03 10:35:32:INFO:Refine time: 31 / 60
2022-06-03 10:35:58:INFO:LR: 0.009477, Acc: 0.6398 (10237.0/16000), Loss: 1.3606
2022-06-03 10:36:00:INFO:Refine Top-1 Accuracy: 63.42
2022-06-03 10:36:00:INFO:Stage2: Saving best model..
2022-06-03 10:36:00:INFO:Refine time: 32 / 60
2022-06-03 10:36:25:INFO:LR: 0.008955, Acc: 0.6449 (10318.0/16000), Loss: 1.3596
2022-06-03 10:36:28:INFO:Refine Top-1 Accuracy: 62.88
2022-06-03 10:36:28:INFO:Refine time: 33 / 60
2022-06-03 10:36:53:INFO:LR: 0.008436, Acc: 0.6420 (10272.0/16000), Loss: 1.3598
2022-06-03 10:36:55:INFO:Refine Top-1 Accuracy: 63.19
2022-06-03 10:36:55:INFO:Refine time: 34 / 60
2022-06-03 10:37:20:INFO:LR: 0.007921, Acc: 0.6460 (10336.0/16000), Loss: 1.3591
2022-06-03 10:37:22:INFO:Refine Top-1 Accuracy: 63.16
2022-06-03 10:37:22:INFO:Refine time: 35 / 60
2022-06-03 10:37:47:INFO:LR: 0.007412, Acc: 0.6484 (10374.0/16000), Loss: 1.3572
2022-06-03 10:37:49:INFO:Refine Top-1 Accuracy: 62.97
2022-06-03 10:37:49:INFO:Refine time: 36 / 60
2022-06-03 10:38:15:INFO:LR: 0.006910, Acc: 0.6507 (10411.0/16000), Loss: 1.3580
2022-06-03 10:38:17:INFO:Refine Top-1 Accuracy: 62.78
2022-06-03 10:38:17:INFO:Refine time: 37 / 60
2022-06-03 10:38:44:INFO:LR: 0.006416, Acc: 0.6539 (10463.0/16000), Loss: 1.3531
2022-06-03 10:38:46:INFO:Refine Top-1 Accuracy: 63.06
2022-06-03 10:38:46:INFO:Refine time: 38 / 60
2022-06-03 10:39:12:INFO:LR: 0.005933, Acc: 0.6521 (10434.0/16000), Loss: 1.3547
2022-06-03 10:39:14:INFO:Refine Top-1 Accuracy: 63.35
2022-06-03 10:39:14:INFO:Refine time: 39 / 60
2022-06-03 10:39:40:INFO:LR: 0.005460, Acc: 0.6565 (10504.0/16000), Loss: 1.3520
2022-06-03 10:39:42:INFO:Refine Top-1 Accuracy: 63.59
2022-06-03 10:39:42:INFO:Stage2: Saving best model..
2022-06-03 10:39:42:INFO:Refine time: 40 / 60
2022-06-03 10:40:08:INFO:LR: 0.005000, Acc: 0.6609 (10574.0/16000), Loss: 1.3520
2022-06-03 10:40:10:INFO:Refine Top-1 Accuracy: 63.88
2022-06-03 10:40:10:INFO:Stage2: Saving best model..
2022-06-03 10:40:11:INFO:Refine time: 41 / 60
2022-06-03 10:40:37:INFO:LR: 0.004554, Acc: 0.6623 (10597.0/16000), Loss: 1.3490
2022-06-03 10:40:39:INFO:Refine Top-1 Accuracy: 63.86
2022-06-03 10:40:39:INFO:Refine time: 42 / 60
2022-06-03 10:41:05:INFO:LR: 0.004122, Acc: 0.6604 (10566.0/16000), Loss: 1.3509
2022-06-03 10:41:07:INFO:Refine Top-1 Accuracy: 63.91
2022-06-03 10:41:07:INFO:Stage2: Saving best model..
2022-06-03 10:41:07:INFO:Refine time: 43 / 60
2022-06-03 10:41:33:INFO:LR: 0.003707, Acc: 0.6682 (10691.0/16000), Loss: 1.3445
2022-06-03 10:41:35:INFO:Refine Top-1 Accuracy: 63.89
2022-06-03 10:41:35:INFO:Refine time: 44 / 60
2022-06-03 10:42:01:INFO:LR: 0.003309, Acc: 0.6656 (10650.0/16000), Loss: 1.3476
2022-06-03 10:42:03:INFO:Refine Top-1 Accuracy: 63.75
2022-06-03 10:42:03:INFO:Refine time: 45 / 60
2022-06-03 10:42:32:INFO:LR: 0.002929, Acc: 0.6744 (10791.0/16000), Loss: 1.3444
2022-06-03 10:42:35:INFO:Refine Top-1 Accuracy: 64.12
2022-06-03 10:42:35:INFO:Stage2: Saving best model..
2022-06-03 10:42:35:INFO:Refine time: 46 / 60
2022-06-03 10:43:07:INFO:LR: 0.002569, Acc: 0.6680 (10688.0/16000), Loss: 1.3451
2022-06-03 10:43:09:INFO:Refine Top-1 Accuracy: 63.88
2022-06-03 10:43:09:INFO:Refine time: 47 / 60
2022-06-03 10:43:40:INFO:LR: 0.002229, Acc: 0.6727 (10763.0/16000), Loss: 1.3432
2022-06-03 10:43:43:INFO:Refine Top-1 Accuracy: 64.20
2022-06-03 10:43:43:INFO:Stage2: Saving best model..
2022-06-03 10:43:43:INFO:Refine time: 48 / 60
2022-06-03 10:44:14:INFO:LR: 0.001910, Acc: 0.6779 (10846.0/16000), Loss: 1.3398
2022-06-03 10:44:16:INFO:Refine Top-1 Accuracy: 64.50
2022-06-03 10:44:16:INFO:Stage2: Saving best model..
2022-06-03 10:44:16:INFO:Refine time: 49 / 60
2022-06-03 10:44:43:INFO:LR: 0.001613, Acc: 0.6783 (10852.0/16000), Loss: 1.3392
2022-06-03 10:44:45:INFO:Refine Top-1 Accuracy: 64.47
2022-06-03 10:44:45:INFO:Refine time: 50 / 60
2022-06-03 10:45:11:INFO:LR: 0.001340, Acc: 0.6836 (10937.0/16000), Loss: 1.3364
2022-06-03 10:45:13:INFO:Refine Top-1 Accuracy: 64.50
2022-06-03 10:45:13:INFO:Refine time: 51 / 60
2022-06-03 10:45:39:INFO:LR: 0.001090, Acc: 0.6783 (10852.0/16000), Loss: 1.3398
2022-06-03 10:45:41:INFO:Refine Top-1 Accuracy: 64.40
2022-06-03 10:45:41:INFO:Refine time: 52 / 60
2022-06-03 10:46:07:INFO:LR: 0.000865, Acc: 0.6831 (10929.0/16000), Loss: 1.3362
2022-06-03 10:46:09:INFO:Refine Top-1 Accuracy: 64.36
2022-06-03 10:46:09:INFO:Refine time: 53 / 60
2022-06-03 10:46:34:INFO:LR: 0.000664, Acc: 0.6831 (10929.0/16000), Loss: 1.3372
2022-06-03 10:46:36:INFO:Refine Top-1 Accuracy: 64.53
2022-06-03 10:46:36:INFO:Stage2: Saving best model..
2022-06-03 10:46:36:INFO:Refine time: 54 / 60
2022-06-03 10:47:02:INFO:LR: 0.000489, Acc: 0.6871 (10994.0/16000), Loss: 1.3359
2022-06-03 10:47:04:INFO:Refine Top-1 Accuracy: 64.49
2022-06-03 10:47:04:INFO:Refine time: 55 / 60
2022-06-03 10:47:29:INFO:LR: 0.000341, Acc: 0.6852 (10963.0/16000), Loss: 1.3358
2022-06-03 10:47:32:INFO:Refine Top-1 Accuracy: 64.44
2022-06-03 10:47:32:INFO:Refine time: 56 / 60
2022-06-03 10:47:57:INFO:LR: 0.000219, Acc: 0.6903 (11044.0/16000), Loss: 1.3353
2022-06-03 10:47:59:INFO:Refine Top-1 Accuracy: 64.56
2022-06-03 10:47:59:INFO:Stage2: Saving best model..
2022-06-03 10:47:59:INFO:Refine time: 57 / 60
2022-06-03 10:48:24:INFO:LR: 0.000123, Acc: 0.6872 (10995.0/16000), Loss: 1.3363
2022-06-03 10:48:26:INFO:Refine Top-1 Accuracy: 64.60
2022-06-03 10:48:26:INFO:Stage2: Saving best model..
2022-06-03 10:48:26:INFO:Refine time: 58 / 60
2022-06-03 10:48:52:INFO:LR: 0.000055, Acc: 0.6923 (11077.0/16000), Loss: 1.3293
2022-06-03 10:48:54:INFO:Refine Top-1 Accuracy: 64.59
2022-06-03 10:48:54:INFO:Refine time: 59 / 60
2022-06-03 10:49:20:INFO:LR: 0.000014, Acc: 0.6908 (11053.0/16000), Loss: 1.3323
2022-06-03 10:49:21:INFO:Refine Top-1 Accuracy: 64.59
2022-06-03 10:49:21:INFO:Refine time: 60 / 60
2022-06-03 10:49:47:INFO:LR: 0.000000, Acc: 0.6883 (11012.0/16000), Loss: 1.3316
2022-06-03 10:49:49:INFO:Refine Top-1 Accuracy: 64.60
2022-06-03 10:49:49:INFO:Stage2: Best Testing Top 1 Accuracy: 64.60, at Epoch: 57
