2022-06-05 14:11:09:INFO:Namespace(alpha=1, attn_dropout=0.2, attn_mask=True, augment_epoch=10, batch_size=512, beta=1.17, embed_dim=1024, embed_dropout=0.25, k_shot=16, layers=1, lr=0.015, num_heads=1, refine_epoch=20, refine_lr=0.001, relu_dropout=0.2, res_dropout=0.2, temperature=0.05, test_batch_size=512, topK=50, train_epoch=20, transformer_alpha=1.0, transformer_beta=1.17)
2022-06-05 14:11:18:INFO:1000 classes, 7 templates
2022-06-05 14:11:24:INFO:Load data finished.
2022-06-05 14:11:24:INFO:Loading saved text features.
2022-06-05 14:11:24:INFO:Loading training image features
2022-06-05 14:11:24:INFO:start saving testing image features
2022-06-05 14:11:24:INFO:Loading fintuned adapter parameters..
2022-06-05 14:11:24:INFO:Loading testing prototypes and testing zeroshot weights...
2022-06-05 14:11:26:INFO:Refine time: 1 / 20
2022-06-05 14:12:19:INFO:LR: 0.000994, Acc: 0.9614 (15382.0/16000), Loss: 0.1258
2022-06-05 14:14:09:INFO:Refine Top-1 Accuracy: 65.30
2022-06-05 14:14:09:INFO:Stage2: Saving best model..
2022-06-05 14:14:10:INFO:Refine time: 2 / 20
2022-06-05 14:15:02:INFO:LR: 0.000976, Acc: 0.9702 (15523.0/16000), Loss: 0.0963
2022-06-05 14:17:02:INFO:Refine Top-1 Accuracy: 65.41
2022-06-05 14:17:02:INFO:Stage2: Saving best model..
2022-06-05 14:17:02:INFO:Refine time: 3 / 20
2022-06-05 14:17:56:INFO:LR: 0.000946, Acc: 0.9716 (15545.0/16000), Loss: 0.0949
2022-06-05 14:19:58:INFO:Refine Top-1 Accuracy: 65.39
2022-06-05 14:19:58:INFO:Refine time: 4 / 20
2022-06-05 14:20:49:INFO:LR: 0.000905, Acc: 0.9725 (15560.0/16000), Loss: 0.0892
2022-06-05 14:22:43:INFO:Refine Top-1 Accuracy: 65.41
2022-06-05 14:22:43:INFO:Stage2: Saving best model..
2022-06-05 14:22:43:INFO:Refine time: 5 / 20
2022-06-05 14:23:33:INFO:LR: 0.000854, Acc: 0.9747 (15595.0/16000), Loss: 0.0865
2022-06-05 14:25:27:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:25:27:INFO:Refine time: 6 / 20
2022-06-05 14:26:17:INFO:LR: 0.000794, Acc: 0.9704 (15526.0/16000), Loss: 0.0957
2022-06-05 14:28:08:INFO:Refine Top-1 Accuracy: 65.41
2022-06-05 14:28:08:INFO:Refine time: 7 / 20
2022-06-05 14:29:02:INFO:LR: 0.000727, Acc: 0.9726 (15561.0/16000), Loss: 0.0919
2022-06-05 14:30:56:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:30:56:INFO:Refine time: 8 / 20
2022-06-05 14:31:45:INFO:LR: 0.000655, Acc: 0.9729 (15566.0/16000), Loss: 0.0880
2022-06-05 14:33:36:INFO:Refine Top-1 Accuracy: 65.39
2022-06-05 14:33:36:INFO:Refine time: 9 / 20
2022-06-05 14:34:26:INFO:LR: 0.000578, Acc: 0.9711 (15538.0/16000), Loss: 0.0944
2022-06-05 14:36:16:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:36:16:INFO:Refine time: 10 / 20
2022-06-05 14:37:06:INFO:LR: 0.000500, Acc: 0.9707 (15531.0/16000), Loss: 0.1005
2022-06-05 14:39:02:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:39:02:INFO:Refine time: 11 / 20
2022-06-05 14:39:52:INFO:LR: 0.000422, Acc: 0.9724 (15559.0/16000), Loss: 0.0902
2022-06-05 14:41:47:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:41:47:INFO:Refine time: 12 / 20
2022-06-05 14:42:37:INFO:LR: 0.000345, Acc: 0.9713 (15541.0/16000), Loss: 0.0926
2022-06-05 14:44:31:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:44:31:INFO:Refine time: 13 / 20
2022-06-05 14:45:21:INFO:LR: 0.000273, Acc: 0.9719 (15551.0/16000), Loss: 0.0923
2022-06-05 14:47:15:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:47:15:INFO:Refine time: 14 / 20
2022-06-05 14:48:08:INFO:LR: 0.000206, Acc: 0.9726 (15561.0/16000), Loss: 0.0919
2022-06-05 14:50:02:INFO:Refine Top-1 Accuracy: 65.39
2022-06-05 14:50:02:INFO:Refine time: 15 / 20
2022-06-05 14:50:52:INFO:LR: 0.000146, Acc: 0.9719 (15551.0/16000), Loss: 0.0889
2022-06-05 14:52:44:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:52:44:INFO:Refine time: 16 / 20
2022-06-05 14:53:34:INFO:LR: 0.000095, Acc: 0.9718 (15549.0/16000), Loss: 0.0959
2022-06-05 14:55:25:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:55:25:INFO:Refine time: 17 / 20
2022-06-05 14:56:17:INFO:LR: 0.000054, Acc: 0.9713 (15541.0/16000), Loss: 0.0923
2022-06-05 14:58:11:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 14:58:11:INFO:Refine time: 18 / 20
2022-06-05 14:59:05:INFO:LR: 0.000024, Acc: 0.9718 (15549.0/16000), Loss: 0.0951
2022-06-05 15:00:54:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 15:00:54:INFO:Refine time: 19 / 20
2022-06-05 15:01:43:INFO:LR: 0.000006, Acc: 0.9718 (15549.0/16000), Loss: 0.0923
2022-06-05 15:03:36:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 15:03:36:INFO:Refine time: 20 / 20
2022-06-05 15:04:26:INFO:LR: 0.000000, Acc: 0.9708 (15533.0/16000), Loss: 0.0935
2022-06-05 15:06:18:INFO:Refine Top-1 Accuracy: 65.40
2022-06-05 15:06:18:INFO:Stage2: Best Testing Top 1 Accuracy: 65.41, at Epoch: 4
2022-06-05 15:06:18:INFO:Begin to search
2022-06-05 15:06:18:INFO:alpha:1.0, beta:0.100
2022-06-05 15:08:13:INFO:New best setting, alpha: 1.00, beta: 0.10; Top-1 acc: 65.41
2022-06-05 15:08:13:INFO:alpha:1.0, beta:0.135
2022-06-05 15:10:11:INFO:alpha:1.0, beta:0.169
2022-06-05 15:12:00:INFO:alpha:1.0, beta:0.204
2022-06-05 15:13:44:INFO:alpha:1.0, beta:0.238
2022-06-05 15:15:29:INFO:alpha:1.0, beta:0.272
2022-06-05 15:17:17:INFO:alpha:1.0, beta:0.307
2022-06-05 15:19:02:INFO:alpha:1.0, beta:0.342
2022-06-05 15:20:45:INFO:alpha:1.0, beta:0.376
2022-06-05 15:22:28:INFO:alpha:1.0, beta:0.410
2022-06-05 15:24:12:INFO:alpha:1.0, beta:0.445
2022-06-05 15:26:03:INFO:alpha:1.0, beta:0.480
2022-06-05 15:27:47:INFO:alpha:1.0, beta:0.514
2022-06-05 15:29:30:INFO:alpha:1.0, beta:0.548
2022-06-05 15:31:15:INFO:alpha:1.0, beta:0.583
2022-06-05 15:33:00:INFO:alpha:1.0, beta:0.617
2022-06-05 15:34:51:INFO:alpha:1.0, beta:0.652
2022-06-05 15:36:34:INFO:alpha:1.0, beta:0.686
2022-06-05 15:38:20:INFO:alpha:1.0, beta:0.721
2022-06-05 15:40:03:INFO:alpha:1.0, beta:0.755
2022-06-05 15:41:45:INFO:alpha:1.0, beta:0.790
2022-06-05 15:43:34:INFO:alpha:1.0, beta:0.825
2022-06-05 15:45:18:INFO:alpha:1.0, beta:0.859
2022-06-05 15:47:01:INFO:alpha:1.0, beta:0.894
2022-06-05 15:48:45:INFO:alpha:1.0, beta:0.928
2022-06-05 15:50:28:INFO:alpha:1.0, beta:0.963
2022-06-05 15:52:16:INFO:alpha:1.0, beta:0.997
2022-06-05 15:54:02:INFO:alpha:1.0, beta:1.032
2022-06-05 15:55:48:INFO:alpha:1.0, beta:1.066
2022-06-05 15:57:34:INFO:alpha:1.0, beta:1.101
2022-06-05 15:59:20:INFO:alpha:1.0, beta:1.135
2022-06-05 16:01:10:INFO:alpha:1.0, beta:1.170
2022-06-05 16:02:55:INFO:alpha:1.0, beta:1.204
2022-06-05 16:04:39:INFO:alpha:1.0, beta:1.239
2022-06-05 16:06:23:INFO:alpha:1.0, beta:1.273
2022-06-05 16:08:14:INFO:alpha:1.0, beta:1.308
2022-06-05 16:10:00:INFO:alpha:1.0, beta:1.342
2022-06-05 16:11:45:INFO:alpha:1.0, beta:1.377
2022-06-05 16:13:26:INFO:alpha:1.0, beta:1.411
2022-06-05 16:15:06:INFO:alpha:1.0, beta:1.446
2022-06-05 16:16:54:INFO:alpha:1.0, beta:1.480
2022-06-05 16:18:33:INFO:alpha:1.0, beta:1.515
2022-06-05 16:20:16:INFO:alpha:1.0, beta:1.549
2022-06-05 16:21:57:INFO:alpha:1.0, beta:1.584
2022-06-05 16:23:43:INFO:alpha:1.0, beta:1.618
2022-06-05 16:25:32:INFO:alpha:1.0, beta:1.653
2022-06-05 16:27:14:INFO:alpha:1.0, beta:1.687
2022-06-05 16:28:55:INFO:alpha:1.0, beta:1.722
2022-06-05 16:30:37:INFO:alpha:1.0, beta:1.756
