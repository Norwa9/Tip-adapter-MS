2022-06-02 13:17:37:INFO:Namespace(alpha=1, attn_dropout=0.2, attn_mask=True, augment_epoch=10, batch_size=512, beta=1.17, embed_dim=1024, embed_dropout=0.25, k_shot=16, layers=1, lr=0.015, num_heads=1, refine_epoch=20, refine_lr=0.005, relu_dropout=0.2, res_dropout=0.2, temperature=0.05, topK=5, train_epoch=20, transformer_alpha=1.0, transformer_beta=1.17)
2022-06-02 13:17:49:INFO:1000 classes, 7 templates
2022-06-02 13:18:06:INFO:Load data finished.
2022-06-02 13:18:06:INFO:Loading saved text features.
2022-06-02 13:18:06:INFO:Loading training image features
2022-06-02 13:18:07:INFO:start saving testing image features
2022-06-02 13:18:07:INFO:Loading fintuned adapter parameters..
2022-06-02 13:18:07:INFO:Loading testing prototypes and testing zeroshot weights...
2022-06-02 13:18:09:INFO:Refine time: 1 / 20
2022-06-02 13:18:36:INFO:LR: 0.004969, Acc: 0.5351 (8561.0/16000), Loss: 1.7747
2022-06-02 13:18:38:INFO:Refine Top-1 Accuracy: 61.05
2022-06-02 13:18:38:INFO:Stage2: Saving best model..
2022-06-02 13:18:38:INFO:Refine time: 2 / 20
2022-06-02 13:19:05:INFO:LR: 0.004878, Acc: 0.6401 (10241.0/16000), Loss: 1.7707
2022-06-02 13:19:07:INFO:Refine Top-1 Accuracy: 62.88
2022-06-02 13:19:07:INFO:Stage2: Saving best model..
2022-06-02 13:19:07:INFO:Refine time: 3 / 20
2022-06-02 13:19:34:INFO:LR: 0.004728, Acc: 0.6601 (10561.0/16000), Loss: 1.7701
2022-06-02 13:19:36:INFO:Refine Top-1 Accuracy: 63.03
2022-06-02 13:19:36:INFO:Stage2: Saving best model..
2022-06-02 13:19:36:INFO:Refine time: 4 / 20
2022-06-02 13:20:03:INFO:LR: 0.004523, Acc: 0.6603 (10564.0/16000), Loss: 1.7700
2022-06-02 13:20:05:INFO:Refine Top-1 Accuracy: 63.13
2022-06-02 13:20:05:INFO:Stage2: Saving best model..
2022-06-02 13:20:05:INFO:Refine time: 5 / 20
2022-06-02 13:20:30:INFO:LR: 0.004268, Acc: 0.6673 (10676.0/16000), Loss: 1.7696
2022-06-02 13:20:32:INFO:Refine Top-1 Accuracy: 63.23
2022-06-02 13:20:32:INFO:Stage2: Saving best model..
2022-06-02 13:20:32:INFO:Refine time: 6 / 20
2022-06-02 13:20:58:INFO:LR: 0.003969, Acc: 0.6702 (10723.0/16000), Loss: 1.7694
2022-06-02 13:21:00:INFO:Refine Top-1 Accuracy: 63.38
2022-06-02 13:21:00:INFO:Stage2: Saving best model..
2022-06-02 13:21:00:INFO:Refine time: 7 / 20
2022-06-02 13:21:27:INFO:LR: 0.003635, Acc: 0.6736 (10778.0/16000), Loss: 1.7692
2022-06-02 13:21:29:INFO:Refine Top-1 Accuracy: 63.57
2022-06-02 13:21:29:INFO:Stage2: Saving best model..
2022-06-02 13:21:29:INFO:Refine time: 8 / 20
2022-06-02 13:21:55:INFO:LR: 0.003273, Acc: 0.6786 (10857.0/16000), Loss: 1.7687
2022-06-02 13:21:57:INFO:Refine Top-1 Accuracy: 63.87
2022-06-02 13:21:57:INFO:Stage2: Saving best model..
2022-06-02 13:21:57:INFO:Refine time: 9 / 20
2022-06-02 13:22:23:INFO:LR: 0.002891, Acc: 0.6909 (11054.0/16000), Loss: 1.7677
2022-06-02 13:22:25:INFO:Refine Top-1 Accuracy: 64.22
2022-06-02 13:22:25:INFO:Stage2: Saving best model..
2022-06-02 13:22:25:INFO:Refine time: 10 / 20
2022-06-02 13:22:51:INFO:LR: 0.002500, Acc: 0.7035 (11256.0/16000), Loss: 1.7664
2022-06-02 13:22:52:INFO:Refine Top-1 Accuracy: 64.63
2022-06-02 13:22:52:INFO:Stage2: Saving best model..
2022-06-02 13:22:53:INFO:Refine time: 11 / 20
2022-06-02 13:23:18:INFO:LR: 0.002109, Acc: 0.7134 (11414.0/16000), Loss: 1.7641
2022-06-02 13:23:20:INFO:Refine Top-1 Accuracy: 65.14
2022-06-02 13:23:20:INFO:Stage2: Saving best model..
2022-06-02 13:23:20:INFO:Refine time: 12 / 20
2022-06-02 13:23:47:INFO:LR: 0.001727, Acc: 0.7189 (11503.0/16000), Loss: 1.7616
2022-06-02 13:23:49:INFO:Refine Top-1 Accuracy: 65.31
2022-06-02 13:23:49:INFO:Stage2: Saving best model..
2022-06-02 13:23:49:INFO:Refine time: 13 / 20
2022-06-02 13:24:15:INFO:LR: 0.001365, Acc: 0.7376 (11801.0/16000), Loss: 1.7590
2022-06-02 13:24:17:INFO:Refine Top-1 Accuracy: 65.31
2022-06-02 13:24:17:INFO:Stage2: Saving best model..
2022-06-02 13:24:17:INFO:Refine time: 14 / 20
2022-06-02 13:24:43:INFO:LR: 0.001031, Acc: 0.7589 (12143.0/16000), Loss: 1.7570
2022-06-02 13:24:45:INFO:Refine Top-1 Accuracy: 65.26
2022-06-02 13:24:45:INFO:Refine time: 15 / 20
2022-06-02 13:25:11:INFO:LR: 0.000732, Acc: 0.7820 (12512.0/16000), Loss: 1.7554
2022-06-02 13:25:13:INFO:Refine Top-1 Accuracy: 65.21
2022-06-02 13:25:13:INFO:Refine time: 16 / 20
2022-06-02 13:25:39:INFO:LR: 0.000477, Acc: 0.7995 (12792.0/16000), Loss: 1.7541
2022-06-02 13:25:41:INFO:Refine Top-1 Accuracy: 65.19
2022-06-02 13:25:41:INFO:Refine time: 17 / 20
2022-06-02 13:26:12:INFO:LR: 0.000272, Acc: 0.8043 (12869.0/16000), Loss: 1.7533
2022-06-02 13:26:15:INFO:Refine Top-1 Accuracy: 65.12
2022-06-02 13:26:15:INFO:Refine time: 18 / 20
2022-06-02 13:26:44:INFO:LR: 0.000122, Acc: 0.8097 (12956.0/16000), Loss: 1.7531
2022-06-02 13:26:46:INFO:Refine Top-1 Accuracy: 65.13
2022-06-02 13:26:46:INFO:Refine time: 19 / 20
2022-06-02 13:27:13:INFO:LR: 0.000031, Acc: 0.8137 (13019.0/16000), Loss: 1.7528
2022-06-02 13:27:15:INFO:Refine Top-1 Accuracy: 65.13
2022-06-02 13:27:15:INFO:Refine time: 20 / 20
2022-06-02 13:27:41:INFO:LR: 0.000000, Acc: 0.8169 (13071.0/16000), Loss: 1.7527
2022-06-02 13:27:43:INFO:Refine Top-1 Accuracy: 65.12
2022-06-02 13:27:43:INFO:Stage2: Best Testing Top 1 Accuracy: 65.31, at Epoch: 13
2022-06-02 13:27:43:INFO:Begin to search
2022-06-02 13:27:43:INFO:alpha:1.0, beta:0.100
2022-06-02 13:27:46:INFO:New best setting, alpha: 1.00, beta: 0.10; Top-1 acc: 61.57
2022-06-02 13:27:46:INFO:alpha:1.0, beta:0.135
2022-06-02 13:27:48:INFO:New best setting, alpha: 1.00, beta: 0.13; Top-1 acc: 61.83
2022-06-02 13:27:48:INFO:alpha:1.0, beta:0.169
2022-06-02 13:27:51:INFO:New best setting, alpha: 1.00, beta: 0.17; Top-1 acc: 62.16
2022-06-02 13:27:51:INFO:alpha:1.0, beta:0.204
2022-06-02 13:27:54:INFO:New best setting, alpha: 1.00, beta: 0.20; Top-1 acc: 62.45
2022-06-02 13:27:54:INFO:alpha:1.0, beta:0.238
2022-06-02 13:27:56:INFO:New best setting, alpha: 1.00, beta: 0.24; Top-1 acc: 62.70
2022-06-02 13:27:56:INFO:alpha:1.0, beta:0.272
2022-06-02 13:27:58:INFO:New best setting, alpha: 1.00, beta: 0.27; Top-1 acc: 62.95
2022-06-02 13:27:58:INFO:alpha:1.0, beta:0.307
2022-06-02 13:28:01:INFO:New best setting, alpha: 1.00, beta: 0.31; Top-1 acc: 63.20
2022-06-02 13:28:01:INFO:alpha:1.0, beta:0.342
2022-06-02 13:28:03:INFO:New best setting, alpha: 1.00, beta: 0.34; Top-1 acc: 63.41
2022-06-02 13:28:03:INFO:alpha:1.0, beta:0.376
2022-06-02 13:28:05:INFO:New best setting, alpha: 1.00, beta: 0.38; Top-1 acc: 63.60
2022-06-02 13:28:05:INFO:alpha:1.0, beta:0.410
2022-06-02 13:28:07:INFO:New best setting, alpha: 1.00, beta: 0.41; Top-1 acc: 63.77
2022-06-02 13:28:08:INFO:alpha:1.0, beta:0.445
2022-06-02 13:28:09:INFO:New best setting, alpha: 1.00, beta: 0.44; Top-1 acc: 63.92
2022-06-02 13:28:10:INFO:alpha:1.0, beta:0.480
2022-06-02 13:28:12:INFO:New best setting, alpha: 1.00, beta: 0.48; Top-1 acc: 64.07
2022-06-02 13:28:12:INFO:alpha:1.0, beta:0.514
2022-06-02 13:28:14:INFO:New best setting, alpha: 1.00, beta: 0.51; Top-1 acc: 64.20
2022-06-02 13:28:14:INFO:alpha:1.0, beta:0.548
2022-06-02 13:28:16:INFO:New best setting, alpha: 1.00, beta: 0.55; Top-1 acc: 64.30
2022-06-02 13:28:16:INFO:alpha:1.0, beta:0.583
2022-06-02 13:28:18:INFO:New best setting, alpha: 1.00, beta: 0.58; Top-1 acc: 64.40
2022-06-02 13:28:18:INFO:alpha:1.0, beta:0.617
2022-06-02 13:28:20:INFO:New best setting, alpha: 1.00, beta: 0.62; Top-1 acc: 64.45
2022-06-02 13:28:20:INFO:alpha:1.0, beta:0.652
2022-06-02 13:28:22:INFO:New best setting, alpha: 1.00, beta: 0.65; Top-1 acc: 64.54
2022-06-02 13:28:22:INFO:alpha:1.0, beta:0.686
2022-06-02 13:28:24:INFO:New best setting, alpha: 1.00, beta: 0.69; Top-1 acc: 64.63
2022-06-02 13:28:24:INFO:alpha:1.0, beta:0.721
2022-06-02 13:28:26:INFO:New best setting, alpha: 1.00, beta: 0.72; Top-1 acc: 64.71
2022-06-02 13:28:26:INFO:alpha:1.0, beta:0.755
2022-06-02 13:28:28:INFO:New best setting, alpha: 1.00, beta: 0.76; Top-1 acc: 64.82
2022-06-02 13:28:28:INFO:alpha:1.0, beta:0.790
2022-06-02 13:28:30:INFO:New best setting, alpha: 1.00, beta: 0.79; Top-1 acc: 64.88
2022-06-02 13:28:30:INFO:alpha:1.0, beta:0.825
2022-06-02 13:28:32:INFO:New best setting, alpha: 1.00, beta: 0.82; Top-1 acc: 64.92
2022-06-02 13:28:32:INFO:alpha:1.0, beta:0.859
2022-06-02 13:28:34:INFO:New best setting, alpha: 1.00, beta: 0.86; Top-1 acc: 65.00
2022-06-02 13:28:34:INFO:alpha:1.0, beta:0.894
2022-06-02 13:28:36:INFO:New best setting, alpha: 1.00, beta: 0.89; Top-1 acc: 65.05
2022-06-02 13:28:36:INFO:alpha:1.0, beta:0.928
2022-06-02 13:28:38:INFO:New best setting, alpha: 1.00, beta: 0.93; Top-1 acc: 65.08
2022-06-02 13:28:38:INFO:alpha:1.0, beta:0.963
2022-06-02 13:28:40:INFO:New best setting, alpha: 1.00, beta: 0.96; Top-1 acc: 65.11
2022-06-02 13:28:40:INFO:alpha:1.0, beta:0.997
2022-06-02 13:28:42:INFO:New best setting, alpha: 1.00, beta: 1.00; Top-1 acc: 65.16
2022-06-02 13:28:42:INFO:alpha:1.0, beta:1.032
2022-06-02 13:28:44:INFO:New best setting, alpha: 1.00, beta: 1.03; Top-1 acc: 65.21
2022-06-02 13:28:45:INFO:alpha:1.0, beta:1.066
2022-06-02 13:28:47:INFO:New best setting, alpha: 1.00, beta: 1.07; Top-1 acc: 65.25
2022-06-02 13:28:47:INFO:alpha:1.0, beta:1.101
2022-06-02 13:28:49:INFO:New best setting, alpha: 1.00, beta: 1.10; Top-1 acc: 65.27
2022-06-02 13:28:49:INFO:alpha:1.0, beta:1.135
2022-06-02 13:28:51:INFO:New best setting, alpha: 1.00, beta: 1.14; Top-1 acc: 65.29
2022-06-02 13:28:51:INFO:alpha:1.0, beta:1.170
2022-06-02 13:28:53:INFO:New best setting, alpha: 1.00, beta: 1.17; Top-1 acc: 65.31
2022-06-02 13:28:53:INFO:alpha:1.0, beta:1.204
2022-06-02 13:28:55:INFO:New best setting, alpha: 1.00, beta: 1.20; Top-1 acc: 65.34
2022-06-02 13:28:55:INFO:alpha:1.0, beta:1.239
2022-06-02 13:28:57:INFO:alpha:1.0, beta:1.273
2022-06-02 13:28:59:INFO:New best setting, alpha: 1.00, beta: 1.27; Top-1 acc: 65.36
2022-06-02 13:28:59:INFO:alpha:1.0, beta:1.308
2022-06-02 13:29:01:INFO:New best setting, alpha: 1.00, beta: 1.31; Top-1 acc: 65.37
2022-06-02 13:29:01:INFO:alpha:1.0, beta:1.342
2022-06-02 13:29:03:INFO:New best setting, alpha: 1.00, beta: 1.34; Top-1 acc: 65.38
2022-06-02 13:29:03:INFO:alpha:1.0, beta:1.377
2022-06-02 13:29:05:INFO:New best setting, alpha: 1.00, beta: 1.38; Top-1 acc: 65.40
2022-06-02 13:29:05:INFO:alpha:1.0, beta:1.411
2022-06-02 13:29:07:INFO:New best setting, alpha: 1.00, beta: 1.41; Top-1 acc: 65.42
2022-06-02 13:29:07:INFO:alpha:1.0, beta:1.446
2022-06-02 13:29:09:INFO:New best setting, alpha: 1.00, beta: 1.45; Top-1 acc: 65.44
2022-06-02 13:29:09:INFO:alpha:1.0, beta:1.480
2022-06-02 13:29:11:INFO:New best setting, alpha: 1.00, beta: 1.48; Top-1 acc: 65.46
2022-06-02 13:29:11:INFO:alpha:1.0, beta:1.515
2022-06-02 13:29:13:INFO:New best setting, alpha: 1.00, beta: 1.51; Top-1 acc: 65.48
2022-06-02 13:29:13:INFO:alpha:1.0, beta:1.549
2022-06-02 13:29:15:INFO:alpha:1.0, beta:1.584
2022-06-02 13:29:17:INFO:New best setting, alpha: 1.00, beta: 1.58; Top-1 acc: 65.49
2022-06-02 13:29:17:INFO:alpha:1.0, beta:1.618
2022-06-02 13:29:19:INFO:alpha:1.0, beta:1.653
2022-06-02 13:29:21:INFO:New best setting, alpha: 1.00, beta: 1.65; Top-1 acc: 65.50
2022-06-02 13:29:21:INFO:alpha:1.0, beta:1.687
2022-06-02 13:29:23:INFO:New best setting, alpha: 1.00, beta: 1.69; Top-1 acc: 65.51
2022-06-02 13:29:23:INFO:alpha:1.0, beta:1.722
2022-06-02 13:29:25:INFO:New best setting, alpha: 1.00, beta: 1.72; Top-1 acc: 65.52
2022-06-02 13:29:25:INFO:alpha:1.0, beta:1.756
2022-06-02 13:29:27:INFO:New best setting, alpha: 1.00, beta: 1.76; Top-1 acc: 65.52
2022-06-02 13:29:27:INFO:alpha:1.0, beta:1.791
2022-06-02 13:29:29:INFO:alpha:1.0, beta:1.825
2022-06-02 13:29:31:INFO:alpha:1.0, beta:1.860
2022-06-02 13:29:33:INFO:alpha:1.0, beta:1.894
2022-06-02 13:29:35:INFO:alpha:1.0, beta:1.929
2022-06-02 13:29:37:INFO:alpha:1.0, beta:1.963
2022-06-02 13:29:39:INFO:alpha:1.0, beta:1.998
