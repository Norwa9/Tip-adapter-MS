2022-06-08 12:11:48:INFO:Namespace(alpha=1, attn_dropout=0.2, attn_mask=True, augment_epoch=10, batch_size=512, beta=1.17, embed_dim=1024, embed_dropout=0.25, k_shot=16, layers=1, lr=0.015, num_heads=1, refine_epoch=20, refine_lr=0.2, relu_dropout=0.2, res_dropout=0.2, temperature=0.05, test_batch_size=512, topK=5, train_epoch=20, transformer_alpha=1.0, transformer_beta=1.17)
2022-06-08 12:11:55:INFO:1000 classes, 7 templates
2022-06-08 12:12:10:INFO:Load data finished.
2022-06-08 12:12:10:INFO:Loading saved text features.
2022-06-08 12:12:10:INFO:Loading training image features
2022-06-08 12:12:10:INFO:start saving testing image features
2022-06-08 12:12:11:INFO:Loading fintuned adapter parameters..
2022-06-08 12:12:11:INFO:Loading testing prototypes and testing zeroshot weights...
2022-06-08 12:12:12:INFO:transformer parameters:13123840
2022-06-08 12:12:12:INFO:Refine time: 1 / 20
2022-06-08 12:12:38:INFO:LR: 0.198769, Acc: 0.9049 (14479.0/16000), Loss: 1.7130
2022-06-08 12:12:41:INFO:Refine Top-1 Accuracy: 61.32
2022-06-08 12:12:41:INFO:Stage2: Saving best model..
2022-06-08 12:12:41:INFO:Refine time: 2 / 20
2022-06-08 12:13:07:INFO:LR: 0.195106, Acc: 0.9374 (14999.0/16000), Loss: 1.6941
2022-06-08 12:13:09:INFO:Refine Top-1 Accuracy: 61.26
2022-06-08 12:13:09:INFO:Refine time: 3 / 20
2022-06-08 12:13:36:INFO:LR: 0.189101, Acc: 0.9400 (15040.0/16000), Loss: 1.6933
2022-06-08 12:13:38:INFO:Refine Top-1 Accuracy: 61.29
2022-06-08 12:13:38:INFO:Refine time: 4 / 20
2022-06-08 12:14:04:INFO:LR: 0.180902, Acc: 0.9387 (15020.0/16000), Loss: 1.6934
2022-06-08 12:14:06:INFO:Refine Top-1 Accuracy: 61.37
2022-06-08 12:14:06:INFO:Stage2: Saving best model..
2022-06-08 12:14:06:INFO:Refine time: 5 / 20
2022-06-08 12:14:32:INFO:LR: 0.170711, Acc: 0.9397 (15035.0/16000), Loss: 1.6931
2022-06-08 12:14:35:INFO:Refine Top-1 Accuracy: 61.28
2022-06-08 12:14:35:INFO:Refine time: 6 / 20
2022-06-08 12:15:00:INFO:LR: 0.158779, Acc: 0.9389 (15023.0/16000), Loss: 1.6932
2022-06-08 12:15:02:INFO:Refine Top-1 Accuracy: 61.31
2022-06-08 12:15:02:INFO:Refine time: 7 / 20
2022-06-08 12:15:27:INFO:LR: 0.145399, Acc: 0.9376 (15001.0/16000), Loss: 1.6931
2022-06-08 12:15:29:INFO:Refine Top-1 Accuracy: 61.32
2022-06-08 12:15:29:INFO:Refine time: 8 / 20
2022-06-08 12:15:55:INFO:LR: 0.130902, Acc: 0.9398 (15037.0/16000), Loss: 1.6928
2022-06-08 12:15:56:INFO:Refine Top-1 Accuracy: 61.56
2022-06-08 12:15:56:INFO:Stage2: Saving best model..
2022-06-08 12:15:57:INFO:Refine time: 9 / 20
2022-06-08 12:16:22:INFO:LR: 0.115643, Acc: 0.9377 (15003.0/16000), Loss: 1.6921
2022-06-08 12:16:24:INFO:Refine Top-1 Accuracy: 63.82
2022-06-08 12:16:24:INFO:Stage2: Saving best model..
2022-06-08 12:16:24:INFO:Refine time: 10 / 20
2022-06-08 12:16:49:INFO:LR: 0.100000, Acc: 0.9229 (14767.0/16000), Loss: 1.6912
2022-06-08 12:16:51:INFO:Refine Top-1 Accuracy: 64.86
2022-06-08 12:16:51:INFO:Stage2: Saving best model..
2022-06-08 12:16:51:INFO:Refine time: 11 / 20
2022-06-08 12:17:16:INFO:LR: 0.084357, Acc: 0.9179 (14686.0/16000), Loss: 1.6911
2022-06-08 12:17:18:INFO:Refine Top-1 Accuracy: 64.68
2022-06-08 12:17:18:INFO:Refine time: 12 / 20
2022-06-08 12:17:44:INFO:LR: 0.069098, Acc: 0.9153 (14644.0/16000), Loss: 1.6906
2022-06-08 12:17:46:INFO:Refine Top-1 Accuracy: 64.81
2022-06-08 12:17:46:INFO:Refine time: 13 / 20
2022-06-08 12:18:11:INFO:LR: 0.054601, Acc: 0.9196 (14713.0/16000), Loss: 1.6907
2022-06-08 12:18:13:INFO:Refine Top-1 Accuracy: 65.14
2022-06-08 12:18:13:INFO:Stage2: Saving best model..
2022-06-08 12:18:13:INFO:Refine time: 14 / 20
2022-06-08 12:18:39:INFO:LR: 0.041221, Acc: 0.9116 (14585.0/16000), Loss: 1.6904
2022-06-08 12:18:40:INFO:Refine Top-1 Accuracy: 65.01
2022-06-08 12:18:40:INFO:Refine time: 15 / 20
2022-06-08 12:19:06:INFO:LR: 0.029289, Acc: 0.9107 (14572.0/16000), Loss: 1.6903
2022-06-08 12:19:08:INFO:Refine Top-1 Accuracy: 65.11
2022-06-08 12:19:08:INFO:Refine time: 16 / 20
2022-06-08 12:19:33:INFO:LR: 0.019098, Acc: 0.9008 (14412.0/16000), Loss: 1.6898
2022-06-08 12:19:34:INFO:Refine Top-1 Accuracy: 64.99
2022-06-08 12:19:34:INFO:Refine time: 17 / 20
2022-06-08 12:20:00:INFO:LR: 0.010899, Acc: 0.9113 (14580.0/16000), Loss: 1.6898
2022-06-08 12:20:02:INFO:Refine Top-1 Accuracy: 65.05
2022-06-08 12:20:02:INFO:Refine time: 18 / 20
2022-06-08 12:20:28:INFO:LR: 0.004894, Acc: 0.9029 (14447.0/16000), Loss: 1.6898
2022-06-08 12:20:30:INFO:Refine Top-1 Accuracy: 65.10
2022-06-08 12:20:30:INFO:Refine time: 19 / 20
2022-06-08 12:20:55:INFO:LR: 0.001231, Acc: 0.9012 (14419.0/16000), Loss: 1.6895
2022-06-08 12:20:57:INFO:Refine Top-1 Accuracy: 65.08
2022-06-08 12:20:57:INFO:Refine time: 20 / 20
2022-06-08 12:21:22:INFO:LR: 0.000000, Acc: 0.9027 (14443.0/16000), Loss: 1.6893
2022-06-08 12:21:24:INFO:Refine Top-1 Accuracy: 65.08
2022-06-08 12:21:24:INFO:Stage2: Best Testing Top 1 Accuracy: 65.14, at Epoch: 13
2022-06-08 12:21:24:INFO:Begin to search
2022-06-08 12:21:24:INFO:alpha:1.0, beta:0.100
2022-06-08 12:21:26:INFO:New best setting, alpha: 1.00, beta: 0.10; Top-1 acc: 63.67
2022-06-08 12:21:26:INFO:alpha:1.0, beta:0.135
2022-06-08 12:21:28:INFO:New best setting, alpha: 1.00, beta: 0.13; Top-1 acc: 64.18
2022-06-08 12:21:28:INFO:alpha:1.0, beta:0.169
2022-06-08 12:21:30:INFO:New best setting, alpha: 1.00, beta: 0.17; Top-1 acc: 64.57
2022-06-08 12:21:30:INFO:alpha:1.0, beta:0.204
2022-06-08 12:21:32:INFO:New best setting, alpha: 1.00, beta: 0.20; Top-1 acc: 64.88
2022-06-08 12:21:32:INFO:alpha:1.0, beta:0.238
2022-06-08 12:21:34:INFO:New best setting, alpha: 1.00, beta: 0.24; Top-1 acc: 65.03
2022-06-08 12:21:34:INFO:alpha:1.0, beta:0.272
2022-06-08 12:21:36:INFO:New best setting, alpha: 1.00, beta: 0.27; Top-1 acc: 65.21
2022-06-08 12:21:36:INFO:alpha:1.0, beta:0.307
2022-06-08 12:21:38:INFO:New best setting, alpha: 1.00, beta: 0.31; Top-1 acc: 65.27
2022-06-08 12:21:38:INFO:alpha:1.0, beta:0.342
2022-06-08 12:21:40:INFO:New best setting, alpha: 1.00, beta: 0.34; Top-1 acc: 65.32
2022-06-08 12:21:40:INFO:alpha:1.0, beta:0.376
2022-06-08 12:21:42:INFO:New best setting, alpha: 1.00, beta: 0.38; Top-1 acc: 65.38
2022-06-08 12:21:42:INFO:alpha:1.0, beta:0.410
2022-06-08 12:21:44:INFO:New best setting, alpha: 1.00, beta: 0.41; Top-1 acc: 65.41
2022-06-08 12:21:44:INFO:alpha:1.0, beta:0.445
2022-06-08 12:21:46:INFO:alpha:1.0, beta:0.480
2022-06-08 12:21:48:INFO:alpha:1.0, beta:0.514
2022-06-08 12:21:50:INFO:alpha:1.0, beta:0.548
2022-06-08 12:21:52:INFO:alpha:1.0, beta:0.583
2022-06-08 12:21:54:INFO:alpha:1.0, beta:0.617
2022-06-08 12:21:56:INFO:alpha:1.0, beta:0.652
2022-06-08 12:21:58:INFO:alpha:1.0, beta:0.686
2022-06-08 12:22:00:INFO:alpha:1.0, beta:0.721
2022-06-08 12:22:01:INFO:alpha:1.0, beta:0.755
2022-06-08 12:22:03:INFO:alpha:1.0, beta:0.790
2022-06-08 12:22:05:INFO:alpha:1.0, beta:0.825
2022-06-08 12:22:07:INFO:alpha:1.0, beta:0.859
2022-06-08 12:22:09:INFO:alpha:1.0, beta:0.894
2022-06-08 12:22:11:INFO:alpha:1.0, beta:0.928
2022-06-08 12:22:13:INFO:alpha:1.0, beta:0.963
2022-06-08 12:22:15:INFO:alpha:1.0, beta:0.997
2022-06-08 12:22:17:INFO:alpha:1.0, beta:1.032
2022-06-08 12:22:18:INFO:alpha:1.0, beta:1.066
2022-06-08 12:22:20:INFO:alpha:1.0, beta:1.101
2022-06-08 12:22:22:INFO:alpha:1.0, beta:1.135
2022-06-08 12:22:24:INFO:alpha:1.0, beta:1.170
2022-06-08 12:22:26:INFO:alpha:1.0, beta:1.204
2022-06-08 12:22:28:INFO:alpha:1.0, beta:1.239
2022-06-08 12:22:30:INFO:alpha:1.0, beta:1.273
2022-06-08 12:22:32:INFO:alpha:1.0, beta:1.308
2022-06-08 12:22:34:INFO:alpha:1.0, beta:1.342
2022-06-08 12:22:36:INFO:alpha:1.0, beta:1.377
2022-06-08 12:22:38:INFO:alpha:1.0, beta:1.411
2022-06-08 12:22:40:INFO:alpha:1.0, beta:1.446
2022-06-08 12:22:41:INFO:alpha:1.0, beta:1.480
2022-06-08 12:22:43:INFO:alpha:1.0, beta:1.515
2022-06-08 12:22:45:INFO:alpha:1.0, beta:1.549
2022-06-08 12:22:47:INFO:alpha:1.0, beta:1.584
2022-06-08 12:22:49:INFO:alpha:1.0, beta:1.618
2022-06-08 12:22:51:INFO:alpha:1.0, beta:1.653
2022-06-08 12:22:53:INFO:alpha:1.0, beta:1.687
2022-06-08 12:22:55:INFO:alpha:1.0, beta:1.722
2022-06-08 12:22:57:INFO:alpha:1.0, beta:1.756
2022-06-08 12:22:58:INFO:alpha:1.0, beta:1.791
2022-06-08 12:23:00:INFO:alpha:1.0, beta:1.825
2022-06-08 12:23:02:INFO:alpha:1.0, beta:1.860
2022-06-08 12:23:04:INFO:alpha:1.0, beta:1.894
2022-06-08 12:23:06:INFO:alpha:1.0, beta:1.929
2022-06-08 12:23:08:INFO:alpha:1.0, beta:1.963
2022-06-08 12:23:10:INFO:alpha:1.0, beta:1.998
2022-06-08 12:23:12:INFO:alpha:1.0, beta:2.032
2022-06-08 12:23:14:INFO:alpha:1.0, beta:2.067
2022-06-08 12:23:15:INFO:alpha:1.0, beta:2.101
2022-06-08 12:23:17:INFO:alpha:1.0, beta:2.136
2022-06-08 12:23:19:INFO:alpha:1.0, beta:2.170
2022-06-08 12:23:21:INFO:alpha:1.0, beta:2.205
2022-06-08 12:23:23:INFO:alpha:1.0, beta:2.239
2022-06-08 12:23:25:INFO:alpha:1.0, beta:2.274
2022-06-08 12:23:27:INFO:alpha:1.0, beta:2.308
2022-06-08 12:23:29:INFO:alpha:1.0, beta:2.343
2022-06-08 12:23:31:INFO:alpha:1.0, beta:2.377
2022-06-08 12:23:32:INFO:alpha:1.0, beta:2.412
2022-06-08 12:23:34:INFO:alpha:1.0, beta:2.446
2022-06-08 12:23:36:INFO:alpha:1.0, beta:2.481
2022-06-08 12:23:38:INFO:alpha:1.0, beta:2.515
2022-06-08 12:23:40:INFO:alpha:1.0, beta:2.550
2022-06-08 12:23:42:INFO:alpha:1.0, beta:2.584
2022-06-08 12:23:44:INFO:alpha:1.0, beta:2.619
2022-06-08 12:23:46:INFO:alpha:1.0, beta:2.653
2022-06-08 12:23:48:INFO:alpha:1.0, beta:2.688
2022-06-08 12:23:49:INFO:alpha:1.0, beta:2.722
2022-06-08 12:23:51:INFO:alpha:1.0, beta:2.757
2022-06-08 12:23:53:INFO:alpha:1.0, beta:2.791
2022-06-08 12:23:55:INFO:alpha:1.0, beta:2.826
2022-06-08 12:23:57:INFO:alpha:1.0, beta:2.860
2022-06-08 12:23:59:INFO:alpha:1.0, beta:2.894
2022-06-08 12:24:01:INFO:alpha:1.0, beta:2.929
2022-06-08 12:24:03:INFO:alpha:1.0, beta:2.964
2022-06-08 12:24:05:INFO:alpha:1.0, beta:2.998
2022-06-08 12:24:06:INFO:alpha:1.0, beta:3.033
2022-06-08 12:24:08:INFO:alpha:1.0, beta:3.067
2022-06-08 12:24:10:INFO:alpha:1.0, beta:3.102
2022-06-08 12:24:12:INFO:alpha:1.0, beta:3.136
2022-06-08 12:24:14:INFO:alpha:1.0, beta:3.171
2022-06-08 12:24:16:INFO:alpha:1.0, beta:3.205
2022-06-08 12:24:18:INFO:alpha:1.0, beta:3.240
2022-06-08 12:24:20:INFO:alpha:1.0, beta:3.274
2022-06-08 12:24:22:INFO:alpha:1.0, beta:3.309
2022-06-08 12:24:23:INFO:alpha:1.0, beta:3.343
2022-06-08 12:24:25:INFO:alpha:1.0, beta:3.377
2022-06-08 12:24:27:INFO:alpha:1.0, beta:3.412
2022-06-08 12:24:29:INFO:alpha:1.0, beta:3.447
2022-06-08 12:24:31:INFO:alpha:1.0, beta:3.481
2022-06-08 12:24:33:INFO:alpha:1.0, beta:3.516
2022-06-08 12:24:35:INFO:alpha:1.0, beta:3.550
2022-06-08 12:24:37:INFO:alpha:1.0, beta:3.585
2022-06-08 12:24:39:INFO:alpha:1.0, beta:3.619
2022-06-08 12:24:40:INFO:alpha:1.0, beta:3.654
2022-06-08 12:24:42:INFO:alpha:1.0, beta:3.688
2022-06-08 12:24:44:INFO:alpha:1.0, beta:3.723
2022-06-08 12:24:46:INFO:alpha:1.0, beta:3.757
2022-06-08 12:24:48:INFO:alpha:1.0, beta:3.792
2022-06-08 12:24:50:INFO:alpha:1.0, beta:3.826
2022-06-08 12:24:52:INFO:alpha:1.0, beta:3.861
2022-06-08 12:24:54:INFO:alpha:1.0, beta:3.895
2022-06-08 12:24:56:INFO:alpha:1.0, beta:3.930
2022-06-08 12:24:57:INFO:alpha:1.0, beta:3.964
2022-06-08 12:24:59:INFO:alpha:1.0, beta:3.999
2022-06-08 12:25:01:INFO:alpha:1.0, beta:4.033
2022-06-08 12:25:03:INFO:alpha:1.0, beta:4.067
2022-06-08 12:25:05:INFO:alpha:1.0, beta:4.102
2022-06-08 12:25:07:INFO:alpha:1.0, beta:4.136
2022-06-08 12:25:09:INFO:alpha:1.0, beta:4.171
2022-06-08 12:25:11:INFO:alpha:1.0, beta:4.205
2022-06-08 12:25:12:INFO:alpha:1.0, beta:4.240
2022-06-08 12:25:14:INFO:alpha:1.0, beta:4.274
2022-06-08 12:25:16:INFO:alpha:1.0, beta:4.309
2022-06-08 12:25:18:INFO:alpha:1.0, beta:4.343
2022-06-08 12:25:20:INFO:alpha:1.0, beta:4.378
2022-06-08 12:25:22:INFO:alpha:1.0, beta:4.412
2022-06-08 12:25:24:INFO:alpha:1.0, beta:4.447
2022-06-08 12:25:26:INFO:alpha:1.0, beta:4.481
2022-06-08 12:25:28:INFO:alpha:1.0, beta:4.516
2022-06-08 12:25:29:INFO:alpha:1.0, beta:4.550
2022-06-08 12:25:31:INFO:alpha:1.0, beta:4.585
2022-06-08 12:25:33:INFO:alpha:1.0, beta:4.620
2022-06-08 12:25:35:INFO:alpha:1.0, beta:4.654
2022-06-08 12:25:37:INFO:alpha:1.0, beta:4.688
2022-06-08 12:25:39:INFO:alpha:1.0, beta:4.723
2022-06-08 12:25:41:INFO:alpha:1.0, beta:4.757
2022-06-08 12:25:43:INFO:alpha:1.0, beta:4.792
2022-06-08 12:25:45:INFO:alpha:1.0, beta:4.827
2022-06-08 12:25:46:INFO:alpha:1.0, beta:4.861
2022-06-08 12:25:48:INFO:alpha:1.0, beta:4.896
2022-06-08 12:25:50:INFO:alpha:1.0, beta:4.930
2022-06-08 12:25:52:INFO:alpha:1.0, beta:4.965
2022-06-08 12:25:54:INFO:alpha:1.0, beta:4.999
2022-06-08 12:25:56:INFO:alpha:1.0, beta:5.034
2022-06-08 12:25:58:INFO:alpha:1.0, beta:5.068
2022-06-08 12:26:00:INFO:alpha:1.0, beta:5.103
2022-06-08 12:26:02:INFO:alpha:1.0, beta:5.137
2022-06-08 12:26:03:INFO:alpha:1.0, beta:5.171
2022-06-08 12:26:05:INFO:alpha:1.0, beta:5.206
2022-06-08 12:26:07:INFO:alpha:1.0, beta:5.240
2022-06-08 12:26:09:INFO:alpha:1.0, beta:5.275
2022-06-08 12:26:11:INFO:alpha:1.0, beta:5.309
2022-06-08 12:26:13:INFO:alpha:1.0, beta:5.344
2022-06-08 12:26:15:INFO:alpha:1.0, beta:5.378
2022-06-08 12:26:17:INFO:alpha:1.0, beta:5.413
2022-06-08 12:26:18:INFO:alpha:1.0, beta:5.447
2022-06-08 12:26:20:INFO:alpha:1.0, beta:5.482
2022-06-08 12:26:22:INFO:alpha:1.0, beta:5.516
2022-06-08 12:26:24:INFO:alpha:1.0, beta:5.551
